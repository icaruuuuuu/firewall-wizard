{
  "config": {
    "version": "1.0",
    "name": "Firewall Corporativo",
    "default_policy": "deny",
    "description": "Configuração básica de firewall para servidor web",
    "last_updated": "2024-01-15T10:00:00Z"
  },
  "tables": [
    {
      "name": "filter",
      "family": "inet",
      "description": "Tabela principal de filtragem de pacotes"
    },
    {
      "name": "nat",
      "family": "ip",
      "description": "Tabela para Network Address Translation"
    }
  ],
  "chains": [
    {
      "table_id": "t1",
      "name": "input",
      "type": "filter",
      "hook": "input",
      "priority": 0,
      "policy": "drop",
      "description": "Cadeia para tráfego de entrada no sistema"
    },
    {
      "table_id": "t1",
      "name": "forward",
      "type": "filter",
      "hook": "forward",
      "priority": 0,
      "policy": "drop",
      "description": "Cadeia para tráfego sendo encaminhado"
    },
    {
      "table_id": "t1",
      "name": "output",
      "type": "filter",
      "hook": "output",
      "priority": 0,
      "policy": "accept",
      "description": "Cadeia para tráfego de saída do sistema"
    },
    {
      "table_id": "t2",
      "name": "prerouting",
      "type": "nat",
      "hook": "prerouting",
      "priority": -100,
      "policy": null,
      "description": "Cadeia para NAT antes do roteamento"
    },
    {
      "table_id": "t2",
      "name": "postrouting",
      "type": "nat",
      "hook": "postrouting",
      "priority": 100,
      "policy": null,
      "description": "Cadeia para NAT depois do roteamento"
    }
  ],
  "rules": [
    {
      "chain_id": "c1",
      "position": 1,
      "description": "Permitir interface loopback",
      "matches": [
        {
          "type": "interface",
          "interface": "lo",
          "direction": "input"
        }
      ],
      "action": "accept",
      "counter": true,
      "enabled": true
    },
    {
      "chain_id": "c1",
      "position": 2,
      "description": "Permitir conexões estabelecidas e relacionadas",
      "matches": [
        {
          "type": "state",
          "states": [
            "established",
            "related"
          ]
        }
      ],
      "action": "accept",
      "counter": true,
      "enabled": true
    },
    {
      "chain_id": "c1",
      "position": 3,
      "description": "SSH apenas de redes administrativas com rate limiting",
      "matches": [
        {
          "type": "protocol",
          "protocol": "tcp",
          "destination_port": 22
        },
        {
          "type": "ip",
          "source_address": "@admin_networks"
        },
        {
          "type": "limit",
          "rate": "5/minute",
          "burst": 10
        }
      ],
      "action": "accept",
      "counter": true,
      "enabled": true
    },
    {
      "chain_id": "c1",
      "position": 4,
      "description": "Serviços web nas portas padrão",
      "matches": [
        {
          "type": "protocol",
          "protocol": "tcp",
          "destination_port": "@web_ports"
        }
      ],
      "action": "accept",
      "counter": true,
      "enabled": true
    },
    {
      "chain_id": "c1",
      "position": 5,
      "description": "Proteção contra ICMP flood",
      "matches": [
        {
          "type": "protocol",
          "protocol": "icmp"
        },
        {
          "type": "limit",
          "rate": "2/second",
          "burst": 5
        }
      ],
      "action": "accept",
      "enabled": true
    },
    {
      "chain_id": "c1",
      "position": 6,
      "description": "Bloquear IPs com excesso de tentativas SSH",
      "matches": [
        {
          "type": "ip",
          "source_address": "@ssh_abusers"
        }
      ],
      "action": "drop",
      "enabled": true
    },
    {
      "chain_id": "c1",
      "position": 7,
      "description": "Detectar e bloquear abuso de SSH",
      "matches": [
        {
          "type": "protocol",
          "protocol": "tcp",
          "destination_port": 22
        },
        {
          "type": "limit",
          "rate": "10/minute",
          "burst": 5
        }
      ],
      "action": "add_to_set",
      "set_target": "s3",
      "enabled": true
    },
    {
      "chain_id": "c1",
      "position": 8,
      "description": "Log de tráfego bloqueado",
      "matches": [
        {
          "type": "all"
        }
      ],
      "action": "log",
      "log_config": {
        "prefix": "Firewall-Denied: ",
        "level": "warn"
      },
      "enabled": true
    },
    {
      "chain_id": "c4",
      "position": 1,
      "description": "Redirecionar HTTP para servidor interno",
      "matches": [
        {
          "type": "protocol",
          "protocol": "tcp",
          "destination_port": 80
        }
      ],
      "action": "dnat",
      "nat_target": "192.168.1.100:8080",
      "enabled": true
    },
    {
      "chain_id": "c5",
      "position": 1,
      "description": "NAT para tráfego de saída na internet",
      "matches": [
        {
          "type": "interface",
          "interface": "eth0",
          "direction": "output"
        }
      ],
      "action": "masquerade",
      "enabled": true
    },
    {
      "chain_id": "c2",
      "position": 1,
      "description": "Permitir encaminhamento entre redes internas",
      "matches": [
        {
          "type": "ip",
          "source_address": "192.168.1.0/24",
          "destination_address": "10.1.1.0/24"
        }
      ],
      "action": "accept",
      "enabled": true
    },
    {
      "chain_id": "c3",
      "position": 1,
      "description": "Bloquear saída para IPs maliciosos",
      "matches": [
        {
          "type": "ip",
          "destination_address": "203.0.113.0/24"
        }
      ],
      "action": "drop",
      "enabled": true
    }
  ],
  "logs": [
    {
      "date": "2025-09-26",
      "time": "21:14:02",
      "source_ip": "203.0.113.12",
      "source_port": "54321",
      "dest_ip": "10.0.0.5",
      "dest_port": "80",
      "action": "Allow"
    },
    {
      "date": "2025-09-26",
      "time": "20:38:54",
      "source_ip": "188.55.1.70",
      "source_port": "22",
      "dest_ip": "10.0.0.5",
      "dest_port": "443",
      "action": "Block"
    },
    {
      "date": "2025-09-26",
      "time": "20:37:02",
      "source_ip": "10.0.0.5",
      "source_port": "49152",
      "dest_ip": "188.55.1.70",
      "dest_port": "53",
      "action": "Allow"
    },
    {
      "date": "2025-09-25",
      "time": "15:23:41",
      "source_ip": "192.168.1.15",
      "source_port": "3389",
      "dest_ip": "10.0.0.8",
      "dest_port": "22",
      "action": "Allow"
    },
    {
      "date": "2025-09-25",
      "time": "14:12:33",
      "source_ip": "45.76.122.89",
      "source_port": "25",
      "dest_ip": "10.0.0.12",
      "dest_port": "993",
      "action": "Block"
    },
    {
      "date": "2025-09-25",
      "time": "11:05:17",
      "source_ip": "10.0.0.5",
      "source_port": "49153",
      "dest_ip": "8.8.8.8",
      "dest_port": "53",
      "action": "Allow"
    },
    {
      "date": "2025-09-24",
      "time": "09:45:28",
      "source_ip": "172.217.16.206",
      "source_port": "443",
      "dest_ip": "10.0.0.5",
      "dest_port": "49154",
      "action": "Allow"
    },
    {
      "date": "2025-09-24",
      "time": "08:32:11",
      "source_ip": "104.18.32.45",
      "source_port": "80",
      "dest_ip": "10.0.0.15",
      "dest_port": "8080",
      "action": "Block"
    },
    {
      "date": "2025-09-23",
      "time": "22:15:47",
      "source_ip": "10.0.0.7",
      "source_port": "49155",
      "dest_ip": "1.1.1.1",
      "dest_port": "53",
      "action": "Allow"
    },
    {
      "date": "2025-09-23",
      "time": "19:28:33",
      "source_ip": "93.184.216.34",
      "source_port": "443",
      "dest_ip": "10.0.0.5",
      "dest_port": "49156",
      "action": "Allow"
    },
    {
      "date": "2025-09-22",
      "time": "16:42:19",
      "source_ip": "185.143.234.12",
      "source_port": "21",
      "dest_ip": "10.0.0.9",
      "dest_port": "21",
      "action": "Block"
    },
    {
      "date": "2025-09-22",
      "time": "13:27:55",
      "source_ip": "10.0.0.5",
      "source_port": "49157",
      "dest_ip": "208.67.222.222",
      "dest_port": "53",
      "action": "Allow"
    },
    {
      "date": "2025-09-21",
      "time": "10:18:42",
      "source_ip": "76.223.125.73",
      "source_port": "1433",
      "dest_ip": "10.0.0.5",
      "dest_port": "1433",
      "action": "Block"
    },
    {
      "date": "2025-09-21",
      "time": "07:53:26",
      "source_ip": "10.0.0.11",
      "source_port": "49158",
      "dest_ip": "142.251.32.110",
      "dest_port": "443",
      "action": "Allow"
    },
    {
      "date": "2025-09-20",
      "time": "23:41:38",
      "source_ip": "151.101.194.217",
      "source_port": "80",
      "dest_ip": "10.0.0.5",
      "dest_port": "49159",
      "action": "Allow"
    },
    {
      "date": "2025-09-20",
      "time": "18:29:14",
      "source_ip": "34.120.182.45",
      "source_port": "25",
      "dest_ip": "10.0.0.18",
      "dest_port": "587",
      "action": "Block"
    },
    {
      "date": "2025-09-19",
      "time": "14:36:27",
      "source_ip": "10.0.0.5",
      "source_port": "49160",
      "dest_ip": "91.198.174.192",
      "dest_port": "80",
      "action": "Allow"
    },
    {
      "date": "2025-09-19",
      "time": "12:22:08",
      "source_ip": "203.0.113.45",
      "source_port": "22",
      "dest_ip": "10.0.0.5",
      "dest_port": "22",
      "action": "Block"
    },
    {
      "date": "2025-09-18",
      "time": "08:15:39",
      "source_ip": "10.0.0.6",
      "source_port": "49161",
      "dest_ip": "185.199.108.153",
      "dest_port": "443",
      "action": "Allow"
    },
    {
      "date": "2025-09-18",
      "time": "05:47:52",
      "source_ip": "198.51.100.23",
      "source_port": "993",
      "dest_ip": "10.0.0.5",
      "dest_port": "993",
      "action": "Allow"
    },
    {
      "date": "2025-09-17",
      "time": "03:28:41",
      "source_ip": "10.0.0.5",
      "source_port": "49162",
      "dest_ip": "192.0.78.25",
      "dest_port": "80",
      "action": "Block"
    },
    {
      "date": "2025-09-17",
      "time": "01:19:37",
      "source_ip": "54.192.143.21",
      "source_port": "443",
      "dest_ip": "10.0.0.14",
      "dest_port": "49163",
      "action": "Allow"
    },
    {
      "date": "2025-09-16",
      "time": "22:08:44",
      "source_ip": "10.0.0.5",
      "source_port": "49164",
      "dest_ip": "104.244.42.129",
      "dest_port": "21",
      "action": "Allow"
    },
    {
      "date": "2025-09-16",
      "time": "20:51:29",
      "source_ip": "172.64.155.87",
      "source_port": "23",
      "dest_ip": "10.0.0.5",
      "dest_port": "23",
      "action": "Block"
    },
    {
      "date": "2025-09-15",
      "time": "17:39:16",
      "source_ip": "10.0.0.13",
      "source_port": "49165",
      "dest_ip": "199.232.65.114",
      "dest_port": "443",
      "action": "Allow"
    },
    {
      "date": "2025-09-15",
      "time": "15:24:33",
      "source_ip": "203.0.113.89",
      "source_port": "110",
      "dest_ip": "10.0.0.5",
      "dest_port": "110",
      "action": "Allow"
    },
    {
      "date": "2025-09-14",
      "time": "11:17:58",
      "source_ip": "10.0.0.5",
      "source_port": "49166",
      "dest_ip": "151.101.130.217",
      "dest_port": "80",
      "action": "Block"
    },
    {
      "date": "2025-09-14",
      "time": "09:42:11",
      "source_ip": "98.137.246.72",
      "source_port": "80",
      "dest_ip": "10.0.0.16",
      "dest_port": "49167",
      "action": "Allow"
    },
    {
      "date": "2025-09-13",
      "time": "06:35:47",
      "source_ip": "10.0.0.5",
      "source_port": "49168",
      "dest_ip": "185.199.111.153",
      "dest_port": "443",
      "action": "Allow"
    }
  ]
}