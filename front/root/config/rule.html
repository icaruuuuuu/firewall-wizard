<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nova Regra - Firewall Wizard</title>
  <link rel="stylesheet" href="css/rule.css">
</head>
<body>

<main class="container">
  <div class="card">
    
    <div class="header">
      <h2>üîê Nova Regra</h2>
      <p class="header-subtitle">Configure uma regra para o firewall nftables</p>
    </div>

    <div class="form-container">

        <form id="ruleForm">

          <fieldset>
            <legend>üìù Identifica√ß√£o da Regra</legend>
            <div class="form-group">
              <label for="description">Descri√ß√£o *</label>
              <input 
                type="text" 
                id="description" 
                name="description"
                placeholder="Ex: Permitir SSH apenas de redes administrativas"
                required
              />
              <p class="help-text">Descri√ß√£o clara da regra</p>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="family">Family *</label>
                <select id="family" name="family" required>
                  <option value="">Selecione...</option>
                  <option value="inet">inet (IPv4 + IPv6)</option>
                  <option value="ip">ip (IPv4)</option>
                  <option value="ip6">ip6 (IPv6)</option>
                  <option value="arp">arp</option>
                  <option value="bridge">bridge</option>
                </select>
              </div>

              <div class="form-group">
                <label for="table">Tabela *</label>
                <select id="table" name="table" required>
                  <option value="">Selecione...</option>
                  <option value="filter">filter</option>
                  <option value="nat">nat</option>
                  <option value="mangle">mangle</option>
                  <option value="raw">raw</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="chain">Chain *</label>
                <select id="chain" name="chain" required>
                  <option value="">Selecione...</option>
                  <option value="input">input</option>
                  <option value="output">output</option>
                  <option value="forward">forward</option>
                  <option value="prerouting">prerouting</option>
                  <option value="postrouting">postrouting</option>
                </select>
              </div>

              <div class="form-group">
                <label for="position">Posi√ß√£o *</label>
                <input 
                  type="number" 
                  id="position" 
                  name="position"
                  placeholder="Ex: 1"
                  min="1"
                  value="1"
                />
                <p class="help-text">Posi√ß√£o na cadeia</p>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>üéØ Crit√©rios de Correspond√™ncia</legend>
            <div class="form-group">
              <label for="matchType">Tipo de Correspond√™ncia *</label>
              <select id="matchType" name="matchType" required>
                <option value="">Selecione...</option>
                <option value="interface">Interface</option>
                <option value="state">Estado de Conex√£o</option>
                <option value="protocol">Protocolo</option>
                <option value="ip">Endere√ßo IP</option>
                <option value="limit">Limite de Taxa</option>
                <option value="all">Todas as Conex√µes</option>
              </select>
            </div>

            <div id="match-interface" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="interface">Interface</label>
                  <input 
                    type="text" 
                    id="interface" 
                    name="interface"
                    placeholder="Ex: eth0, lo"
                  />
                </div>

                <div class="form-group">
                  <label for="interfaceDir">Dire√ß√£o</label>
                  <select id="interfaceDir" name="interfaceDir">
                    <option value="input">Input</option>
                    <option value="output">Output</option>
                  </select>
                </div>
              </div>
            </div>

            <div id="match-state" class="match-section" style="display: none;">
              <div class="form-group">
                <label>Estados de Conex√£o</label>
                <div class="checkbox-group">
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="established" /> Established
                  </label>
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="related" /> Related
                  </label>
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="new" /> New
                  </label>
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="invalid" /> Invalid
                  </label>
                </div>
              </div>
            </div>

            <div id="match-protocol" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="protocol">Protocolo</label>
                  <select id="protocol" name="protocol">
                    <option value="">Selecione...</option>
                    <option value="tcp">TCP</option>
                    <option value="udp">UDP</option>
                    <option value="icmp">ICMP</option>
                    <option value="esp">ESP</option>
                    <option value="ah">AH</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="destPort">Porta Destino</label>
                  <input 
                    type="text" 
                    id="destPort" 
                    name="destPort"
                    placeholder="Ex: 22 ou 80,443 ou 3000:4000"
                  />
                </div>

                <div class="form-group">
                  <label for="srcPort">Porta Origem</label>
                  <input 
                    type="text" 
                    id="srcPort" 
                    name="srcPort"
                    placeholder="Ex: 1024:65535"
                  />
                </div>
              </div>
            </div>

            <div id="match-ip" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="srcAddr">Endere√ßo Origem</label>
                  <input 
                    type="text" 
                    id="srcAddr" 
                    name="srcAddr"
                    placeholder="Ex: 192.168.1.0/24 ou @admin_networks"
                  />
                </div>

                <div class="form-group">
                  <label for="destAddr">Endere√ßo Destino</label>
                  <input 
                    type="text" 
                    id="destAddr" 
                    name="destAddr"
                    placeholder="Ex: 10.0.0.0/8"
                  />
                </div>
              </div>
            </div>

            <div id="match-limit" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="rate">Taxa</label>
                  <input 
                    type="text" 
                    id="rate" 
                    name="rate"
                    placeholder="Ex: 5/minute ou 10/second"
                    value="5/minute"
                  />
                </div>

                <div class="form-group">
                  <label for="burst">Burst</label>
                  <input 
                    type="number" 
                    id="burst" 
                    name="burst"
                    placeholder="Ex: 10"
                    value="10"
                    min="1"
                  />
                </div>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>‚ö° A√ß√£o</legend>
            <div class="form-group">
              <label for="action">A√ß√£o *</label>
              <select id="action" name="action" required>
                <option value="">Selecione...</option>
                <option value="accept">Accept (Aceitar)</option>
                <option value="drop">Drop (Descartar)</option>
                <option value="reject">Reject (Rejeitar)</option>
                <option value="log">Log (Registrar)</option>
                <option value="dnat">DNAT (Network Address Translation)</option>
                <option value="snat">SNAT (Network Address Translation)</option>
                <option value="masquerade">Masquerade (Mascarar)</option>
                <option value="add_to_set">Add to Set (Adicionar a conjunto)</option>
              </select>
            </div>

            <div id="action-dnat" class="action-section" style="display: none;">
              <div class="form-group">
                <label for="natTarget">Alvo NAT</label>
                <input 
                  type="text" 
                  id="natTarget" 
                  name="natTarget"
                  placeholder="Ex: 192.168.1.100:8080"
                />
              </div>
            </div>

            <div id="action-log" class="action-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="logPrefix">Prefixo do Log</label>
                  <input 
                    type="text" 
                    id="logPrefix" 
                    name="logPrefix"
                    placeholder="Ex: Firewall-Denied: "
                  />
                </div>

                <div class="form-group">
                  <label for="logLevel">N√≠vel</label>
                  <select id="logLevel" name="logLevel">
                    <option value="debug">Debug</option>
                    <option value="info">Info</option>
                    <option value="warn">Warn</option>
                    <option value="err">Error</option>
                  </select>
                </div>
              </div>
            </div>

            <div id="action-set" class="action-section" style="display: none;">
              <div class="form-group">
                <label for="setTarget">Alvo do Conjunto</label>
                <input 
                  type="text" 
                  id="setTarget" 
                  name="setTarget"
                  placeholder="Ex: ssh_abusers"
                />
              </div>
            </div>

            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="counter" name="counter" checked />
                Habilitar Contador
              </label>
            </div>
          </fieldset>

          <fieldset>
            <legend>‚öôÔ∏è Configura√ß√µes Adicionais</legend>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="enabled" name="enabled" checked />
                Regra Ativa
              </label>
            </div>

            <div class="form-group">
              <label for="comment">Coment√°rio</label>
              <textarea 
                id="comment" 
                name="comment"
                placeholder="Adicione notas sobre esta regra..."
              ></textarea>
            </div>
          </fieldset>

          <div class="form-actions">
            <a href="rulelist.html" class="btn btn-secondary">‚Üê Cancelar</a>
            <button type="submit" class="btn btn-primary">
              <span>‚úì</span> Salvar Regra
            </button>
          </div>

        </form>
      </div>

    </div>
  </main>

  <script src="ruleconfig.js"></script>

  </body>
  </html>
