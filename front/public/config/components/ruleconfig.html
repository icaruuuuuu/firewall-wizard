<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>New Rule - Firewall Wizard</title>
  <link rel="stylesheet" href="../../css/config.css">
</head>
<body>

<main class="container">
  <div class="card">
    
    <div class="header">
      <h2>üîê New Rule</h2>
      <p class="header-subtitle">Configure a nftable firewall rule</p>
    </div>

    <div class="form-container">

        <form id="ruleForm">

          <fieldset>
            <legend>üìù Rule Identification</legend>
            <div class="form-group">
              <label for="description">Description *</label>
              <input 
                type="text" 
                id="description" 
                name="description"
                placeholder="Ex: Allow SSH only on administrative networks"
                required
              />
              <p class="help-text">Rule's description</p>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="family">Family *</label>
                <select id="family" name="family" required>
                  <option value="">Select...</option>
                  <option value="inet">inet (IPv4 + IPv6)</option>
                  <option value="ip">ip (IPv4)</option>
                  <option value="ip6">ip6 (IPv6)</option>
                  <option value="arp">arp</option>
                  <option value="bridge">bridge</option>
                </select>
              </div>

              <div class="form-group">
                <label for="table">Table *</label>
                <select id="table" name="table" required>
                  <option value="">Select...</option>
                  <option value="filter">filter</option>
                  <option value="nat">nat</option>
                  <option value="mangle">mangle</option>
                  <option value="raw">raw</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="chain">Chain *</label>
                <select id="chain" name="chain" required>
                  <option value="">Select...</option>
                  <option value="input">input</option>
                  <option value="output">output</option>
                  <option value="forward">forward</option>
                  <option value="prerouting">prerouting</option>
                  <option value="postrouting">postrouting</option>
                </select>
              </div>

              <div class="form-group">
                <label for="position">Position *</label>
                <input 
                  type="number" 
                  id="position" 
                  name="position"
                  placeholder="Ex: 1"
                  min="1"
                  value="1"
                />
                <p class="help-text">Position in the chain</p>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>üéØ Matching Criteria</legend>
            <div class="form-group">
              <label for="matchType">Matching Type *</label>
              <select id="matchType" name="matchType" required>
                <option value="">Select...</option>
                <option value="interface">Interface</option>
                <option value="state">Connection State</option>
                <option value="protocol">Protocol</option>
                <option value="ip">IP Adress</option>
                <option value="limit">Rate Limit</option>
                <option value="all">All Connections</option>
              </select>
            </div>

            <div id="match-interface" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="interface">Interface</label>
                  <input 
                    type="text" 
                    id="interface" 
                    name="interface"
                    placeholder="Ex: eth0, lo"
                  />
                </div>

                <div class="form-group">
                  <label for="interfaceDir">Direction</label>
                  <select id="interfaceDir" name="interfaceDir">
                    <option value="input">Input</option>
                    <option value="output">Output</option>
                  </select>
                </div>
              </div>
            </div>

            <div id="match-state" class="match-section" style="display: none;">
              <div class="form-group">
                <label>Connection States</label>
                <div class="checkbox-group">
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="established" /> Established
                  </label>
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="related" /> Related
                  </label>
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="new" /> New
                  </label>
                  <label class="checkbox-label">
                    <input type="checkbox" name="states" value="invalid" /> Invalid
                  </label>
                </div>
              </div>
            </div>

            <div id="match-protocol" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="protocol">Protocol</label>
                  <select id="protocol" name="protocol">
                    <option value="">Select...</option>
                    <option value="tcp">TCP</option>
                    <option value="udp">UDP</option>
                    <option value="icmp">ICMP</option>
                    <option value="esp">ESP</option>
                    <option value="ah">AH</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="destPort">Destination Port</label>
                  <input 
                    type="text" 
                    id="destPort" 
                    name="destPort"
                    placeholder="Ex: 22 or 80,443 or 3000:4000"
                  />
                </div>

                <div class="form-group">
                  <label for="srcPort">Source Port</label>
                  <input 
                    type="text" 
                    id="srcPort" 
                    name="srcPort"
                    placeholder="Ex: 1024:65535"
                  />
                </div>
              </div>
            </div>

            <div id="match-ip" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="srcAddr">Source Address</label>
                  <input 
                    type="text" 
                    id="srcAddr" 
                    name="srcAddr"
                    placeholder="Ex: 192.168.1.0/24 or @admin_networks"
                  />
                </div>

                <div class="form-group">
                  <label for="destAddr">Destination Address</label>
                  <input 
                    type="text" 
                    id="destAddr" 
                    name="destAddr"
                    placeholder="Ex: 10.0.0.0/8"
                  />
                </div>
              </div>
            </div>

            <div id="match-limit" class="match-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="rate">Rate</label>
                  <input 
                    type="text" 
                    id="rate" 
                    name="rate"
                    placeholder="Ex: 5/minute or 10/second"
                    value="5/minute"
                  />
                </div>

                <div class="form-group">
                  <label for="burst">Burst</label>
                  <input 
                    type="number" 
                    id="burst" 
                    name="burst"
                    placeholder="Ex: 10"
                    value="10"
                    min="1"
                  />
                </div>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>‚ö° Action</legend>
            <div class="form-group">
              <label for="action">Action *</label>
              <select id="action" name="action" required>
                <option value="">Select...</option>
                <option value="accept">Accept</option>
                <option value="drop">Drop</option>
                <option value="reject">Reject</option>
                <option value="log">Log</option>
                <option value="dnat">DNAT (Network Address Translation)</option>
                <option value="snat">SNAT (Network Address Translation)</option>
                <option value="masquerade">Masquerade</option>
                <option value="add_to_set">Add to Set</option>
              </select>
            </div>

            <div id="action-dnat" class="action-section" style="display: none;">
              <div class="form-group">
                <label for="natTarget">NAT Target</label>
                <input 
                  type="text" 
                  id="natTarget" 
                  name="natTarget"
                  placeholder="Ex: 192.168.1.100:8080"
                />
              </div>
            </div>

            <div id="action-log" class="action-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="logPrefix">Log Prefix</label>
                  <input 
                    type="text" 
                    id="logPrefix" 
                    name="logPrefix"
                    placeholder="Ex: Firewall-Denied: "
                  />
                </div>

                <div class="form-group">
                  <label for="logLevel">Level</label>
                  <select id="logLevel" name="logLevel">
                    <option value="debug">Debug</option>
                    <option value="info">Info</option>
                    <option value="warn">Warn</option>
                    <option value="err">Error</option>
                  </select>
                </div>
              </div>
            </div>

            <div id="action-set" class="action-section" style="display: none;">
              <div class="form-group">
                <label for="setTarget">Set Target</label>
                <input 
                  type="text" 
                  id="setTarget" 
                  name="setTarget"
                  placeholder="Ex: ssh_abusers"
                />
              </div>
            </div>

            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="counter" name="counter" checked />
                Enable Counter
              </label>
            </div>
          </fieldset>

          <fieldset>
            <legend>‚öôÔ∏è Extra Configurations</legend>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="enabled" name="enabled" checked />
                Active Rule
              </label>
            </div>

            <div class="form-group">
              <label for="comment">Comment</label>
              <textarea 
                id="comment" 
                name="comment"
                placeholder="Add notes about this rule..."
              ></textarea>
            </div>
          </fieldset>

          <div class="form-actions">
            <button onclick="" class="btn btn-secondary btn-cancel">‚Üê Cancel</a>
            <button type="submit" class="btn btn-primary">
              <span>‚úì</span> Save Rule
            </button>
          </div>

        </form>
      </div>

    </div>
  </main>

  <script src="../../js/ruleconfig.js"></script>

  </body>
  </html>
