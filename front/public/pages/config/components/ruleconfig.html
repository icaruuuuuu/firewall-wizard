<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>New Rule - Firewall Wizard</title>
  <link rel="stylesheet" href="../../../assets/css/config.css">
</head>

<body>

  <main class="container">
    <div class="card">

      <div class="header">
        <h2>üîê New Rule</h2>
        <p class="header-subtitle">Configure a nftable firewall rule</p>
      </div>

      <div class="form-container">

        <form id="ruleForm">

          <fieldset>
            <legend>üìù Rule Identification</legend>
            <div class="form-group">
              <label for="description">Description *</label>
              <input type="text" id="description" name="description"
                placeholder="Ex: Allow SSH only on administrative networks" required />
              <p class="help-text">Rule's description</p>
            </div>

            <div class="form-group">
              <label for="chainId">Chain *</label>
              <select id="chainId" name="chainId" required>
                <option value="">Select Chain...</option>
                <!-- Op√ß√µes ser√£o preenchidas dinamicamente com Chains do banco -->
                <!-- Exemplo: <option value="1">INPUT (filter table)</option> -->
              </select>
            </div>
          </fieldset>

          <fieldset>
            <legend>‚ö° Statement (Action)</legend>
            <div class="form-group">
              <label for="statement">Statement *</label>
              <select id="statement" name="statement" required>
                <option value="">Select statement...</option>
                <option value="accept">Accept</option>
                <option value="drop">Drop</option>
                <option value="reject">Reject</option>
                <option value="log">Log</option>
                <option value="dnat">DNAT</option>
                <option value="snat">SNAT</option>
                <option value="masquerade">Masquerade</option>
              </select>
            </div>

            <div id="statement-dnat" class="statement-section" style="display: none;">
              <div class="form-group">
                <label for="natTarget">NAT Target</label>
                <input type="text" id="natTarget" name="natTarget" placeholder="Ex: 192.168.1.100:8080" />
              </div>
            </div>

            <div id="statement-log" class="statement-section" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label for="logPrefix">Log Prefix</label>
                  <input type="text" id="logPrefix" name="logPrefix" placeholder="Ex: Firewall-Denied:" />
                </div>

                <div class="form-group">
                  <label for="logLevel">Level</label>
                  <select id="logLevel" name="logLevel">
                    <option value="debug">Debug</option>
                    <option value="info">Info</option>
                    <option value="warn">Warn</option>
                    <option value="err">Error</option>
                  </select>
                </div>
              </div>
            </div>
          </fieldset>

          <fieldset>
            <legend>üîß Expression (Optional)</legend>
            <div class="form-group">
              <label for="expression">Expression</label>
              <textarea id="expression" name="expression"
                placeholder="Complete nftables rule (e.g., 'tcp dport 22, ip saddr 192.168.1.0/24 accept'). Leave empty to auto-generate."
                rows="3"></textarea>
              <p class="help-text">Full nftables rule. If empty, will be generated from match + statement.</p>
            </div>
          </fieldset>

          <div class="form-actions">
            <button type="button" onclick="window.history.back()" class="btn btn-secondary btn-cancel">‚Üê Cancel</button>
            <button type="submit" class="btn btn-primary">
              <span>‚úì</span> Save Rule
            </button>
          </div>

        </form>
      </div>

    </div>
  </main>

  <script type="module" src="../../../js/features/rules/ruleconfig.js"></script>

</body>

</html>
